<!-- TOC -->

- [1. ğŸŒ² es6 ä¹‹ Set å’Œ Map æ•°æ®ç»“æ„](#1-%F0%9F%8C%B2-es6-%E4%B9%8B-set-%E5%92%8C-map-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84)
  - [1.1. Set](#11-set)
    - [1.1.1. åŸºç¡€ç”¨æ³•](#111-%E5%9F%BA%E7%A1%80%E7%94%A8%E6%B3%95)
    - [1.1.2. Set å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•](#112-set-%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95)
    - [1.1.3. éå†æ“ä½œ](#113-%E9%81%8D%E5%8E%86%E6%93%8D%E4%BD%9C)
  - [1.2. WeakSet](#12-weakset)
  - [1.3. Map](#13-map)
    - [1.3.1. æ¦‚å¿µ](#131-%E6%A6%82%E5%BF%B5)
  - [1.4. weakMap ç”¨æ¥éƒ¨ç½²ç§æœ‰å±æ€§](#14-weakmap-%E7%94%A8%E6%9D%A5%E9%83%A8%E7%BD%B2%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7)

<!-- /TOC -->
# 1. ğŸŒ² es6 ä¹‹ Set å’Œ Map æ•°æ®ç»“æ„
## 1.1. Set
### 1.1.1. åŸºç¡€ç”¨æ³•
```javaScript
// å‚æ•°å¾—æœ‰ iterable æ¥å£
[...new Set(array)] // æ•°ç»„å»é‡, ... å†…éƒ¨ä½¿ç”¨ for...of æ–¹æ³•
```
### 1.1.2. Set å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•
```javaScript
set.size() // è¿”å›Setå®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚
set.add() // æ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å› Set ç»“æ„æœ¬èº«ã€‚
set.delete() // åˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸã€‚
set.has() // è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸ºSetçš„æˆå‘˜ã€‚
set.clear() // æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚
```

### 1.1.3. éå†æ“ä½œ
```javaScript
set.keys() // è¿”å›é”®åçš„éå†å™¨
set.values() // è¿”å›é”®å€¼çš„éå†å™¨
set.entries() // è¿”å›é”®å€¼å¯¹çš„éå†å™¨
set.forEach() // ä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜
set.forEach((value, key, item) => console.log(item + ' : ' + key + ' : ' + value))
// [object Set] : 1 : 1
// [object Set] : 4 : 4
// [object Set] : 9 : 9
```

## 1.2. WeakSet

```javaScript
ws.add(1)
ws.add(Symbol())
// éƒ½ä¼šæŠ¥é”™ï¼Œåªèƒ½å­˜å¯¹è±¡
// WeakSet é‡Œé¢çš„å¼•ç”¨ï¼Œéƒ½ä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

WeakSet.prototype.add(value) // å‘ WeakSet å®ä¾‹æ·»åŠ ä¸€ä¸ªæ–°æˆå‘˜ã€‚
WeakSet.prototype.delete(value) // æ¸…é™¤ WeakSet å®ä¾‹çš„æŒ‡å®šæˆå‘˜ã€‚
WeakSet.prototype.has(value) // è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªå€¼æ˜¯å¦åœ¨ 


***â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”***

// WeakSet çš„ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯å‚¨å­˜ DOM èŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿™äº›èŠ‚ç‚¹ä»æ–‡æ¡£ç§»é™¤æ—¶ï¼Œä¼šå¼•å‘å†…å­˜æ³„æ¼ã€‚

const foos = new WeakSet()
class Foo {
  constructor() {
    foos.add(this)
  }
  method () {
    if (!foos.has(this)) {
      throw new TypeError('Foo.prototype.method åªèƒ½åœ¨Fooçš„å®ä¾‹ä¸Šè°ƒç”¨ï¼');
    }
  }
}

// Fooçš„å®ä¾‹æ–¹æ³•ï¼Œåªèƒ½åœ¨Fooçš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚åˆ é™¤å®ä¾‹æ—¶ä¸ä¼šå¼•å‘å†…å­˜æ³„æ¼
```

## 1.3. Map
### 1.3.1. æ¦‚å¿µ
```javaScript
// ç›¸æ¯”ä¼ ç»Ÿå¯¹è±¡ï¼Œé”®å¯ä»¥æ˜¯ä»»ä½•æ•°æ®æ ¼å¼

const set = new Set([
  ['foo', 1],
  ['bar', 2]
]);
const m1 = new Map(set);
m1.get('foo') // 1

const m2 = new Map([['baz', 3]]);
const m3 = new Map(m2);
m3.get('baz') // 3
// Map æ„é€ å‡½æ•°å¯ä»¥ç”¨æ•°ç»„ï¼Œå› ä¸ºæ•°ç»„æœ‰ Iterator æ¥å£ï¼Œ åŒç†ï¼Œæ‰€æœ‰å…·æœ‰ Iterator çš„æ•°æ®éƒ½å¯ä»¥å½“æ„é€ å‡½æ•°çš„å‚æ•°

// Map çš„é”®å®é™…ä¸Šæ˜¯è·Ÿå†…å­˜åœ°å€ç»‘å®šçš„ï¼Œåªè¦å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œå°±è§†ä¸ºä¸¤ä¸ªé”®ã€‚
```

## 1.4. weakMap ç”¨æ¥éƒ¨ç½²ç§æœ‰å±æ€§
```javaScript
const _counter = new WeakMap();
const _action = new WeakMap();

class Countdown {
  constructor(counter, action) {
    _counter.set(this, counter);
    _action.set(this, action);
  }
  dec() {
    let counter = _counter.get(this);
    if (counter < 1) return;
    counter--;
    _counter.set(this, counter);
    if (counter === 0) {
      _action.get(this)();
    }
  }
}

const c = new Countdown(2, () => console.log('DONE'));

c.dec()
c.dec()
// DONE
```


